### **요청과 응답 예시**

Purgo API의 핵심 기능은 프록시 서버를 통해 다음 엔드포인트에서 제공됩니다:

```bash
POST /proxy/analyze

```

이 API는 사용자가 보낸 문장이 욕설인지 **판별**하고, 욕설일 경우 **정제된 문장으로 대체**해 반환합니다.

---

### **요청 헤더 예시**

```
Authorization: Bearer {API_KEY}
X-Auth-Token: {JWT}
Content-Type: application/json
```

> - `Authorization`: 발급받은 API Key  
> - `X-Auth-Token`: 요청 본문을 해시한 JWT (서버에서 생성해야 함)

---

### **요청 바디 예시**

```json
{
  "text": "죽어버려 진짜"
}
```

| 필드   | 타입     | 설명           |
|--------|----------|----------------|
| text   | string   | 욕설 필터링 대상 문장 |

> 이 `text` 필드가 JWT 서명 시 해시 대상이 됩니다.  
> 반드시 JSON을 정렬 후 직렬화하고 SHA-256 해시하여 JWT의 `hash` 필드에 포함해야 합니다.

---

### **응답 예시**

```json
{
  "result": {
    "rewritten_text": "조용히 해",
    "abusive_score": 0.91
  },
  "final_decision": "1"
}
```

| 필드명           | 설명                                    |
|------------------|-----------------------------------------|
| rewritten_text   | 욕설을 정제한 대체 문장                  |
| abusive_score    | 욕설 확률 (0.0 ~ 1.0 사이 부동소수점)     |
| final_decision   | "1": 욕설 있음 / "0": 욕설 아님          |

---

### 통계 및 필터링 사용량 확인

Purgo는 내부적으로 **욕설 필터링 수행 횟수 및 로그**를 자동 수집합니다.  
누적 필터링 수치는 아래 엔드포인트를 통해 확인할 수 있습니다:

```bash
GET /api/filter/count

```


> 응답 예시:
```bash
1529

```

| 항목 | 설명 |
|------|------|
| 누적 필터링 횟수 | 시스템 전체에서 필터링이 실제로 수행된 횟수 |
| 집계 기준 | 욕설이 탐지되어 필터링 로직이 실행된 경우만 카운트 |
| 내부 처리 | Redis 기반 실시간 카운트 + 필터 로그 Pub/Sub 방식 처리 |

※ 사용자별 통계는 추후 제공 예정입니다.

---

### **참고 사항**

- `rewritten_text`는 사용자에게 노출 가능한 **순화 문장**입니다.
- `abusive_score`는 내부 모델이 예측한 **욕설 가능성 확률**입니다.
- `final_decision`은 필터링 여부를 나타내는 **결정값**입니다.
- 인증 실패 시 `401`, 형식 오류 시 `400`, 요청 초과 시 `429`, 내부 오류 시 `500` 등의 상태코드가 반환됩니다.
